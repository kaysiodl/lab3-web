<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Lab3 Web JSF</title>
    <meta charset="UTF-8"/>
</h:head>

<h:body>
    <div class="container">
        <h:form>
            <div class="button-container">
                <h:commandButton class="navigation-button" action="to-index" value="Вернуться на стартовую страницу"/>
            </div>
        </h:form>

        <div id="canvas-container">
            <canvas id="coordinate-system" width="400px" height="400px"/>
        </div>

        <h:form id="point-form" styleClass="point-form">
            <div id="x-container">
                <h:outputLabel for="x" value="Введите X:"
                               style="color:#d48a8a; font-weight: 600"/>
                <p:selectOneRadio id="x" value="#{form.x}" required="true"
                                  requiredMessage="Выберите значение X">
                    <f:converter converterId="jakarta.faces.Double"/>
                    <f:selectItem itemLabel="-5" itemValue="-5"/>
                    <f:selectItem itemLabel="-4" itemValue="-4"/>
                    <f:selectItem itemLabel="-3" itemValue="-3"/>
                    <f:selectItem itemLabel="-2" itemValue="-2"/>
                    <f:selectItem itemLabel="-1" itemValue="-1"/>
                    <f:selectItem itemLabel="0" itemValue="0"/>
                    <f:selectItem itemLabel="1" itemValue="1"/>
                    <f:selectItem itemLabel="2" itemValue="2"/>
                    <f:selectItem itemLabel="3" itemValue="3"/>
                </p:selectOneRadio>
                <p:message for="x"/>
            </div>
            <div id="y-container">
                <h:outputLabel for="y" value="Введите Y:"/>
                <p:inputText id="y" name="y" maxlength="8" required="true" value="#{form.y}">
                    <f:convertNumber minFractionDigits="1" maxFractionDigits="4" locale="US"/>
                    <f:validateDoubleRange minimum="-3" maximum="5"/>
                </p:inputText>
                <p:message for="y"/>
            </div>
            <div id="r-container">
                <h:outputText id="output" value="Выберите R: #{form.r}"
                              style="color:#d48a8a; font-weight: 600"/>
                <h:inputHidden id="r-input" value="#{form.r}"
                               required="true"
                               requiredMessage="Выберите R"/>
                <p:slider for="r-input"
                          display="output"
                          minValue="1.0"
                          maxValue="4.0"
                          step="0.25"
                          displayTemplate="Выберите R: {value}"
                          onSlideEnd="handleR()">
                    <p:ajax event="slideEnd" process="@this r-input" update="output"/>
                </p:slider>
                <p:message for="r-input"/>
            </div>
            <p:commandButton id="submit-button"
                             style="background: #BCB8B8FF; display: block; margin: 0 auto "
                             value="Отправить"
                             action="#{form.save()}"
                             styleClass="submit-button"
                             process="@form"
                             ajax="true"
                             update="table-form point-form"
            />
        </h:form>

        <h:form id="hidden-form" style="display: none">
            <h:inputHidden id="hidden-x" value="#{canvas.x}"/>
            <h:inputHidden id="hidden-y" value="#{canvas.y}"/>
            <h:inputHidden id="hidden-r" value="#{canvas.r}"/>
            <p:commandButton id="hidden-submit"
                             action="#{canvas.save()}"
                             process="@form"
                             ajax="true"
                             update="table-form"
            />
        </h:form>

        <div class="results">
            <h3>Результаты попадания</h3>
            <h:form id="table-form">
                <h:inputHidden id="hidden-results" value="#{results.jsonResults}"/>
                <p:dataTable value="#{results.results}" var="result"
                             rendered="#{not empty results.results}" id="results-table" styleClass="table">
                    <p:column headerText="X">
                        <h:outputText value="#{result.x}"/>
                    </p:column>
                    <p:column headerText="Y">
                        <h:outputText value="#{result.y}"/>
                    </p:column>
                    <p:column headerText="R">
                        <h:outputText value="#{result.r}"/>
                    </p:column>
                    <p:column headerText="Результат">
                        <h:outputText value="#{result.hit}"/>
                    </p:column>
                    <p:column headerText="Время выполнения">
                        <h:outputText value="#{result.executionTime}"/>
                    </p:column>
                    <p:column headerText="Время">
                        <h:outputText value="#{result.currentTime}"/>
                    </p:column>
                </p:dataTable>
                <p:commandButton value="Очистить" action="#{results.clear()}"
                                 styleClass="clear-button"
                                 style="background: #bcb8b8"
                                 process="@form"
                                 ajax="true"
                                 update="table-form"/>
            </h:form>
        </div>
    </div>


    <h:outputScript library="primefaces" name="jquery/jquery.js"/>
    <h:outputScript name="coordinateSystem.js" library="js"/>
    <h:outputScript name="main.js" library="js"/>
    <h:outputStylesheet name="css/styles.css"/>
</h:body>
</html>